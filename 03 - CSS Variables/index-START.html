<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Scoped CSS Variables and JS</title>
  <link rel="icon" href="https://fav.farm/ğŸ”¥" />
</head>

<body>
  <h2>Update CSS Variables with <span class='hl'>JS</span></h2>

  <div class="controls">
    <label for="spacing">Spacing:</label>
    <input id="spacing" type="range" name="spacing" min="10" max="200" value="10" data-sizing="px">

    <label for="blur">Blur:</label>
    <input id="blur" type="range" name="blur" min="0" max="25" value="10" data-sizing="px">

    <label for="base">Base Color</label>
    <input id="base" type="color" name="base" value="#ffc600">
  </div>

  <img src="https://source.unsplash.com/7bwQXzbF6KE/800x500">

  <style>
    /*
      misc styles, nothing to do with CSS variables
      1. :root æ˜¯ CSS çš„å½é¡é¸æ“‡å™¨(pseudo-class selector)ï¼Œè½‰å€‘é¸æ“‡ HTML æ–‡ä»¶çš„æ ¹å…ƒç´ (root element)ã€‚
      2. HTML æ–‡ä»¶ä¸­çš„æ ¹å…ƒç´ å°±æ˜¯ <html>ï¼Œæ‰€ä»¥ :root {} ç­‰åƒ¹æ–¼ html {}
      3. ä½†æ˜¯ :root åœ¨ CSS çš„å„ªå…ˆæ¬Šè¼ƒé«˜
    */

    :root {
      --spacing: 10px;
      --blur: 10px;
      --base: #ffc600;
    }

    .hl {
      color: var(--base);
    }

    img {
      padding: var(--spacing);
      background-color: var(--base);
      filter: blur(var(--blur));
    }

    body {
      text-align: center;
      background: #193549;
      color: white;
      font-family: 'helvetica neue', sans-serif;
      font-weight: 100;
      font-size: 50px;
    }

    .controls {
      margin-bottom: 50px;
    }

    input {
      width: 100px;
    }
  </style>

  <script>
    /* ç¬¬ä¸€æ¬¡å¯«æ³•
    const image = document.querySelector('img')
    const spacing = document.querySelector('#spacing')
    const blur = document.querySelector('#blur')
    const base = document.querySelector('#base')
    const title = document.querySelector('.hl')

    function changeBaseColor(e) {
      image.style.backgroundColor = e.target.value
      title.style.color = base.value
    }

    function inputChangeSpacing(e) {
      image.style.padding = `${e.target.value}px`
    }

    function inputChangeBlur(e) {
      image.style.filter = `blur(${e.target.value}px)`
    }

    function initState() {
      image.style.backgroundColor = base.value
      title.style.color = base.value
      image.style.padding = `${spacing.value}px`
      image.style.filter = `blur(${blur.value}px)`
    }

    base.addEventListener('change', changeBaseColor)
    spacing.addEventListener('input', inputChangeSpacing)
    blur.addEventListener('input', inputChangeBlur)

    initState()
    */


    /*
    1. ä½†æ˜¯ document.documentElement.style.setProperty() é€™é‚Šå¯ä»¥æ‹¿ä¾†ä½¿ç”¨ï¼Œæå‡æ•ˆèƒ½ (ç‰¹åˆ¥é©ç”¨æ–¼éœ€è¦å³æ™‚è®Šæ›´ UI ä¸”å½±éŸ¿ç¯„åœè¼ƒå»£çš„æƒ…å¢ƒï¼Œä¾‹å¦‚ä¸»é¡Œè®Šæ›´ã€å‹•æ…‹æ¨£æ˜¯èª¿æ•´ç­‰)
      1.1 åªæ”¹è®Šéœ€è¦è®Šå‹•çš„ CSS è®Šæ•¸ (ä¸æ˜¯é€éæ”¹è®Š style å±¬æ€§ï¼Œé¿å…ä¸å¿…è¦çš„é‡ç¹ªèˆ‡å›æµ)
      1.2 
        1.2.1 è®“ç€è¦½å™¨æ›´æœ‰æ•ˆçš„è™•ç†æ¨£å¼è®Šæ›´ (CSS è®Šæ•¸æ˜¯åœ¨ç€è¦½å™¨çš„ CSS å±¤ç´šè™•ç†ï¼Œä¸æ˜¯æ”¹è®Š DOM çµæ§‹ï¼Œå› æ­¤ç€è¦½å™¨å¯ä»¥æ›´é«˜æ•ˆæ‡‰ç”¨è®ŠåŒ–)
        1.2.2 æ•´å€‹é é¢å¯ä»¥é€é CSS è®Šæ•¸çš„è®Šæ›´ä¾†å³æ™‚æ›´æ–°æ¨£å¼ï¼Œè€Œç„¡é ˆéæ­·æ‰€æœ‰ç›¸é—œçš„ DOM å…ƒç´ 
      1.3 é™ä½ JavaScript æ“ä½œçš„å½±éŸ¿
      1.4 CSS è®Šæ•¸å¯ä»¥è®“æ¨£å¼å‹•æ…‹è®Šæ›´æ›´ç°¡æ½”
      1.5 æ¸›å°‘ Layout Thrashing (å¸ƒå±€æŠ–å‹•)
        1.5.1 Layout Thrashing æŒ‡çš„æ˜¯é »ç¹çš„è®€å–èˆ‡å¯«å…¥ DOM å±¬æ€§ (ä¾‹å¦‚ offsetWidth) çš„æ“ä½œäº¤éŒ¯é€²è¡Œï¼Œå°è‡´ç€è¦½å™¨ä¸å¾—ä¸é »ç¹é‡æ–°è¨ˆç®—ä½ˆå±€ï¼Œå½±éŸ¿æ•ˆèƒ½ã€‚
        1.5.2 ä½† document.documentElement.style.setProperty() ä¸»è¦å½±åƒ CSS å±¤ç´šçš„è®Šæ•¸ï¼Œä¸æ¶‰åŠå³æ™‚çš„ DOM å±¬æ€§è®€å–ï¼Œå› æ­¤æ›´èƒ½æ¸›å°‘é€™é¡çš„æ•ˆèƒ½å•é¡Œ

    çµè«–: (*** CSS çš„æ±è¥¿èƒ½åœ¨ CSS å±¤ç´šæ”¹å°±æ˜¯æœ€å¥½çš„ ***)
    ä½¿ç”¨ document.documentElement.style.setProperty() ä¾†å‹•æ…‹èª¿æ•´ CSS è®Šæ•¸ï¼Œèƒ½å¤ :
    1. âœ… æ›´é«˜æ•ˆåœ°æ‡‰ç”¨æ¨£å¼è®Šæ›´
    2. âœ… æ¸›å°‘ DOM æ“ä½œï¼Œé™ä½é‡ç¹ªèˆ‡å›æµ
    3. âœ… è®“è®Šæ›´å½±éŸ¿æ‰€æœ‰ä½¿ç”¨è©²è®Šæ•¸çš„å…ƒç´ ï¼Œæ¸›å°‘ç¨‹å¼ç¢¼é‡è¤‡
    4. âœ… é¿å… Layout Thrashingï¼Œæé«˜æ¸²æŸ“æ•ˆèƒ½

    å› æ­¤ï¼Œé€™ç¨®æ–¹å¼ç¢ºå¯¦æ˜¯æ›´å¥½çš„æ•ˆèƒ½å„ªåŒ–ç­–ç•¥ï¼Œç‰¹åˆ¥é©ç”¨æ–¼ éœ€è¦å³æ™‚è®Šæ›´ UI ä¸”å½±éŸ¿ç¯„åœè¼ƒå»£çš„æƒ…å¢ƒï¼ˆå¦‚ä¸»é¡Œè®Šæ›´ã€å‹•æ…‹æ¨£å¼èª¿æ•´ç­‰ï¼‰ã€‚ ğŸš€
    */

    const root = document.documentElement;
    const controls = document.querySelector('.controls')

    function handleChangeCSSVariable(e) {
      const suffix = e.target.dataset.sizing || ''
      const property = `--${e.target.name}`
      root.style.setProperty(property, e.target.value + suffix)
    }

    controls.addEventListener('input', handleChangeCSSVariable)

    // è§£ç­”æ˜¯æ›åœ¨æ¯å€‹ input ä¸Šï¼Œé‚„èƒ½ä½¿ç”¨ this ä¾†ä»£æ›¿ e.target ï¼Œå› ç‚ºæˆ‘æ˜¯ç”¨ event delegate æ‰€ä»¥å¿…é ˆä½¿ç”¨ e.target ä¸ç„¶åªæœƒæ‹¿åˆ° delegate æ›è¼‰çš„å…ƒç´ 
  </script>

</body>

</html>